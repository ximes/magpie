(function(){this.add_to_restorable_path=function(e){var t;return!!window.is_restorable_tree&&(t=e.data("node-id"),nested_tree_path_add(t),!0)},this.remove_from_restorable_path=function(e){var t;return!!window.is_restorable_tree&&(t=e.data("node-id"),nested_tree_path_remove(t),!0)},this.nested_tree_toggle=function(e){return e.hasClass("minus")?e.removeClass("minus").addClass("plus").html("+"):e.removeClass("plus").addClass("minus").html("&ndash;")},this.append_children_to_node=function(e,t){var r,n;if(t=t.trim(),n=e.children(".item"),r=e.children(".item").children(".expand"),0===t.length&&r.addClass("empty"),t.length>0)return n.after(t),nested_tree_toggle(r),add_to_restorable_path(e)},this.upload_nodes_children=function(e,t){var r,n,a;return n=e.data("node-id"),a=$(".sortable_tree"),r=$("i.handle, b.expand",a),$.ajax({type:"POST",dataType:"html",data:{id:n},url:t,beforeSend:function(){return r.hide(),window.skip_expandable_tree_hashchange=!0},success:function(t){return r.show(),append_children_to_node(e,t)},error:function(e,t,r){try{return console.log(r)}catch(e){}}})},this.init_expandable_tree=function(){var e,t,r;return t=$("ol.sortable_tree"),0!==t.length&&(window.is_restorable_tree||(window.is_restorable_tree=!1),window.is_cookie_restoreable_tree=t.data("cookie_store")||t.data("cookie-store"),window.is_cookie_restoreable_tree&&(r=$.cookie(TSTconst.cookie_name()))&&_set_hash(TSTconst.hash_prefix()+r),e=t.data("expand_node_url")||t.data("expand-node-url"),window.is_restorable_tree&&restore_nested_tree(t,e),t.on("click",".expand.minus",function(){var e,t;return e=$(this),t=e.parent().parent(),nested_tree_toggle(e),remove_from_restorable_path(t),t.children(".nested_set").hide(),!1}),t.on("click",".expand.plus",function(){var t,r,n;return t=$(this),n=t.parent().parent(),r=n.children(".nested_set"),0===r.length?upload_nodes_children(n,e):(r.show(),nested_tree_toggle(t),add_to_restorable_path(n)),!1}),!0)},$(function(){return init_expandable_tree()})}).call(this);